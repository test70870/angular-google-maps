{"version":3,"file":"agm-drawing.js","sources":["../../../packages/drawing/src/lib/directives/drawing-manager.ts","../../../packages/drawing/src/lib/directives/drawing-manager-trigger.ts","../../../packages/drawing/src/lib/drawing.module.ts","../../../packages/drawing/src/public-api.ts","../../../packages/drawing/src/agm-drawing.ts"],"sourcesContent":["import { Directive, EventEmitter, Input, isDevMode, NgZone, OnChanges, OnDestroy, Output, SimpleChanges } from '@angular/core';\nimport { fromEventPattern, Observable, Subscription } from 'rxjs';\n\n@Directive({\n  selector: 'agm-drawing-manager',\n  exportAs: 'agmDrawingManager',\n})\nexport class AgmDrawingManager implements OnChanges, OnDestroy{\n\n  /**\n   * The enabled/disabled state of the drawing control. Defaults to `true`.\n   *\n   */\n  @Input() drawingControl: boolean;\n\n  /**\n   * The DrawingManager's drawing mode, which defines the type of overlay to be\n   * added on the map. A drawing mode of null means that the user can interact\n   * with the map as normal, and clicks do not draw anything.\n   */\n  @Input() drawingMode: google.maps.drawing.OverlayType | null;\n\n  /**\n   * The display options for the drawing control.\n   *\n   */\n  @Input() drawingControlOptions: google.maps.drawing.DrawingControlOptions;\n\n  /**\n   * Options to apply to any new circles created with this DrawingManager.\n   * The `center` and `radius` properties are ignored, and the `map` property of a\n   * new circle is always set to the DrawingManager's map.\n   *\n   */\n  @Input() circleOptions: google.maps.CircleOptions;\n\n  /**\n   * Options to apply to any new markers created with this DrawingManager.\n   * The `position` property is ignored, and the `map` property of a new marker\n   * is always set to the DrawingManager's map.\n   *\n   */\n  @Input() markerOptions: google.maps.MarkerOptions;\n\n  /**\n   * Options to apply to any new polygons created with this DrawingManager.\n   * The `paths` property is ignored, and the map property of a new polygon is\n   * always set to the DrawingManager's map.\n   *\n   */\n  @Input() polygonOptions: google.maps.PolygonOptions;\n\n  /**\n   * Options to apply to any new polylines created with this DrawingManager.\n   * The `path` property is ignored, and the map property of a new polyline is\n   * always set to the DrawingManager's map.\n   *\n   */\n  @Input() polylineOptions: google.maps.PolylineOptions;\n\n  /**\n   * Options to apply to any new rectangles created with this DrawingManager.\n   * The `bounds` property is ignored, and the map property of a new rectangle\n   * is always set to the DrawingManager's map.\n   *\n   */\n  @Input() rectangleOptions: google.maps.RectangleOptions;\n\n  /**\n   * This event is fired when the user has finished drawing a circle.\n   */\n  @Output() circleComplete = new EventEmitter<google.maps.Circle>();\n\n  /**\n   * This event is fired when the user has finished drawing a marker.\n   */\n  @Output() markerComplete = new EventEmitter<google.maps.Marker>();\n\n  /**\n   * This event is fired when the user has finished drawing an overlay of any\n   * type.\n   */\n  @Output() overlayComplete = new EventEmitter<google.maps.drawing.OverlayCompleteEvent>();\n\n  /**\n   * This event is fired when the user has finished drawing a polygon.\n   */\n  @Output() polygonComplete = new EventEmitter<google.maps.Polygon>();\n\n  /**\n   * This event is fired when the user has finished drawing a polyline.\n   */\n  @Output() polylineComplete = new EventEmitter<google.maps.Polyline>();\n\n  /**\n   * This event is fired when the user has finished drawing a rectangle.\n   */\n  @Output() rectangleComplete = new EventEmitter<google.maps.Rectangle>();\n\n  private eventSubscriptions: Subscription[] = [];\n\n  private drawingManager: google.maps.drawing.DrawingManager;\n\n  constructor(private _zone: NgZone) {\n  }\n\n  setMap(map: google.maps.Map) {\n    if (!google.maps.drawing && isDevMode()) {\n      console.error('Cannot use drawing manager if drawing library is not ' +\n        'loaded. To fix, add libraries: [\\'drawing\\'] to the ' +\n        'lazyMapsAPILoaderConfig you passed to AgmCoreModule.forRoot');\n      return;\n    }\n    if (map && !this.drawingManager) {\n      this.drawingManager = new google.maps.drawing.DrawingManager({\n          map,\n          circleOptions: this.circleOptions,\n          markerOptions: this.markerOptions,\n          polygonOptions: this.polygonOptions,\n          polylineOptions: this.polylineOptions,\n          rectangleOptions: this.rectangleOptions,\n          drawingControl: this.drawingControl,\n          drawingControlOptions: this.drawingControlOptions,\n          drawingMode: this.drawingMode,\n      });\n      this.initEvents(this.drawingManager);\n    } else if (!map && this.drawingManager) {\n      this.drawingManager.setMap(null);\n    }\n    // else do nothing\n  }\n\n  initEvents(drawingManager: google.maps.drawing.DrawingManager) {\n    this.eventSubscriptions.push(\n      this.createMvcObservable<google.maps.Circle>('circlecomplete', drawingManager)\n      .subscribe(circle => this._zone.run(() => this.circleComplete.next(circle)))\n    );\n    this.eventSubscriptions.push(\n      this.createMvcObservable<google.maps.Marker>('markercomplete', drawingManager)\n      .subscribe(marker => this._zone.run(() => this.markerComplete.next(marker)))\n    );\n    this.eventSubscriptions.push(\n      this.createMvcObservable<google.maps.Polygon>('polygoncomplete', drawingManager)\n      .subscribe(polygon => this._zone.run(() => this.polygonComplete.next(polygon)))\n    );\n    this.eventSubscriptions.push(\n      this.createMvcObservable<google.maps.Polyline>('polylinecomplete', drawingManager)\n      .subscribe(polyline => this._zone.run(() => this.polylineComplete.next(polyline)))\n    );\n    this.eventSubscriptions.push(\n      this.createMvcObservable<google.maps.drawing.OverlayCompleteEvent>('overlaycomplete', drawingManager)\n      .subscribe(overlayevent => this._zone.run(() => this.overlayComplete.next(overlayevent)))\n    );\n    this.eventSubscriptions.push(\n      this.createMvcObservable<google.maps.Rectangle>('rectanglecomplete', drawingManager)\n      .subscribe(rectangle => this._zone.run(() => this.rectangleComplete.next(rectangle)))\n    );\n  }\n\n  createMvcObservable<E>(eventName: string, mvcObject: google.maps.MVCObject): Observable<E> {\n    return fromEventPattern(\n      handler => mvcObject.addListener(eventName,\n        (event?: E) => handler.apply(null, [event])),\n      (_handler, evListener: google.maps.MapsEventListener) => evListener.remove()\n    );\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (!this.drawingManager) {\n      return;\n    }\n\n    const options = Object.entries(changes)\n    .map(([prop, change]) => [prop, change.currentValue])\n    .reduce((obj: any, [propName, propValue]) => {\n      obj[propName] = propValue;\n      return obj;\n    }, {});\n    this.drawingManager.setOptions(options);\n  }\n\n  ngOnDestroy(): void {\n    this.eventSubscriptions.forEach(subscription => subscription.unsubscribe());\n  }\n\n}\n","import { AgmMap } from '@agm/core';\nimport { AfterViewInit, Directive, Host, Input, OnDestroy } from '@angular/core';\nimport { first } from 'rxjs/operators';\nimport { AgmDrawingManager } from './drawing-manager';\n\n@Directive({\n  selector: 'agm-map[agmDrawingManager]',\n  exportAs: 'matDrawingManagerTrigger',\n})\nexport class AgmDrawingManagerTrigger implements AfterViewInit, OnDestroy{\n\n  /** The drawing manager to be attached to this trigger. */\n  // tslint:disable-next-line: no-input-rename\n  @Input('agmDrawingManager') drawingManager: AgmDrawingManager;\n\n  constructor(@Host() private _agmMap: AgmMap) {\n  }\n\n  ngAfterViewInit(): void {\n    this._agmMap.mapReady.pipe(first()).subscribe(map => this.drawingManager.setMap(map));\n  }\n\n  ngOnDestroy() {\n    this._agmMap.mapReady.pipe(first()).subscribe(() => this.drawingManager.setMap(null));\n  }\n}\n","import { AgmCoreModule } from '@agm/core';\nimport { NgModule } from '@angular/core';\nimport { AgmDrawingManager } from './directives/drawing-manager';\nimport { AgmDrawingManagerTrigger } from './directives/drawing-manager-trigger';\n\n@NgModule({\n  imports: [AgmCoreModule],\n  declarations: [AgmDrawingManager, AgmDrawingManagerTrigger],\n  exports: [AgmDrawingManager, AgmDrawingManagerTrigger],\n})\nexport class AgmDrawingModule {\n}\n","/*\n * Public API Surface of drawing\n */\n\nexport * from './lib/directives';\nexport * from './lib/drawing.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}